import{a0 as U,r as m,j as e,c as _,a6 as S,L as M,a1 as O,f as k,l as C,d as g,U as L,M as B,m as E,o as F,b as H,al as I,P as q,am as z,an as P}from"./index-CW7sJ-MG.js";const R=async d=>{try{return(await P.getOrderById(d)).data}catch{return new Promise((h,u)=>{setTimeout(()=>{const a=new Date(Date.now()-Math.random()*30*24*60*60*1e3),o=Math.floor(Math.random()*5)+1,p=Math.floor(Math.random()*5e4)+5e3,n=Math.floor(Math.random()*2e3)+500,j=Math.floor(p*.075),N=p+n+j,f=["pending","processing","shipped","delivered","cancelled"],x=["cash_on_delivery","card","bank_transfer"],y=["paid","pending","refunded"],l=f[Math.floor(Math.random()*f.length)],v=x[Math.floor(Math.random()*x.length)],b=y[Math.floor(Math.random()*y.length)],r=[{status:"created",timestamp:a.toISOString(),note:"Order has been created"}];l!=="cancelled"&&r.push({status:"pending",timestamp:new Date(a.getTime()+Math.random()*24*60*60*1e3).toISOString(),note:"Order is pending processing"}),["processing","shipped","delivered"].includes(l)&&r.push({status:"processing",timestamp:new Date(a.getTime()+Math.random()*2*24*60*60*1e3).toISOString(),note:"Order is being processed"}),["shipped","delivered"].includes(l)&&r.push({status:"shipped",timestamp:new Date(a.getTime()+Math.random()*3*24*60*60*1e3).toISOString(),note:"Order has been shipped via DHL Express"}),l==="delivered"&&r.push({status:"delivered",timestamp:new Date(a.getTime()+Math.random()*4*24*60*60*1e3).toISOString(),note:"Order has been delivered successfully"}),l==="cancelled"&&r.push({status:"cancelled",timestamp:new Date(a.getTime()+Math.random()*24*60*60*1e3).toISOString(),note:"Order was cancelled by the customer"}),r.sort((w,i)=>new Date(w.timestamp)-new Date(i.timestamp)),h({_id:d,orderNumber:`ORD-${1e5+parseInt(d.replace(/\D/g,"")||"1")}`,customer:{_id:`user${Math.floor(Math.random()*1e3)}`,name:"John Doe",email:"john.doe@example.com",phone:"+2348012345678"},items:Array.from({length:o},(w,i)=>({_id:`item${i}`,product:{_id:`product${i*10}`,name:`Product ${i*10}`,image:`https://picsum.photos/id/${i*10%1e3}/400/400`},price:Math.floor(Math.random()*1e4)+1e3,quantity:Math.floor(Math.random()*3)+1,outlet:{_id:`outlet${Math.floor(Math.random()*10)+1}`,name:`Outlet ${Math.floor(Math.random()*10)+1}`}})),shippingAddress:{street:"123 Main Street",city:"Lagos",state:"Lagos",country:"Nigeria",zipCode:"100001"},paymentMethod:v,paymentStatus:b,subtotal:p,shippingFee:n,tax:j,totalAmount:N,status:l,statusHistory:r,createdAt:a.toISOString(),updatedAt:new Date(a.getTime()+Math.random()*24*60*60*1e3).toISOString()})},1e3)})}},J=async(d,t,h)=>{var u,a;try{return{success:!0,message:(await P.updateOrderStatus(d,{status:t,note:h})).data.message||`Order status updated to ${t}`}}catch(o){return console.error("Error updating order status:",o),{success:!1,message:((a=(u=o.response)==null?void 0:u.data)==null?void 0:a.message)||"Failed to update order status"}}},K=()=>{const{id:d}=U(),[t,h]=m.useState(null),[u,a]=m.useState(!0),[o,p]=m.useState(null),[n,j]=m.useState(""),[N,f]=m.useState(""),[x,y]=m.useState(!1),[l,v]=m.useState(""),[b,r]=m.useState("");m.useEffect(()=>{(async()=>{try{a(!0);const c=await R(d);h(c),j(c.status),p(null)}catch{p("Failed to load order details. Please try again later.")}finally{a(!1)}})()},[d]);const w=async s=>{if(s.preventDefault(),n===t.status){r("Please select a different status.");return}try{y(!0),r(""),v("");const c=await J(d,n,N);if(c.success){const D=new Date().toISOString();h(A=>({...A,status:n,statusHistory:[...A.statusHistory,{status:n,timestamp:D,note:N||`Status updated to ${n}`}],updatedAt:D})),v(c.message),f("")}else r("Failed to update order status. Please try again.")}catch{r("An error occurred. Please try again later.")}finally{y(!1)}},i=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"shipped":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";case"created":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},$=s=>{switch(s){case"paid":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"refunded":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},T=s=>{switch(s){case"cash_on_delivery":return"Cash on Delivery";case"card":return"Card Payment";case"bank_transfer":return"Bank Transfer";default:return s}};return u?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(_,{size:"lg"})}):o?e.jsx("div",{className:"bg-gray-50 min-h-screen py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center text-red-500",children:[e.jsx(S,{className:"h-6 w-6 mr-2"}),e.jsx("p",{children:o})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(M,{to:"/admin/orders",className:"text-orange-600 hover:text-orange-900 flex items-center",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Back to Orders"]})})]})})}):t?e.jsx("div",{className:"bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(M,{to:"/admin/orders",className:"text-orange-600 hover:text-orange-900 flex items-center",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Back to Orders"]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("h1",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:["Order #",t.orderNumber]}),e.jsxs("div",{className:"mt-2 sm:mt-0 flex items-center",children:[e.jsx("span",{className:"mr-2 text-sm text-gray-500",children:k(t.createdAt)}),e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${i(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})]})]})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg mb-6",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Update Order Status"}),l&&e.jsx("div",{className:"mt-4 bg-green-50 border-l-4 border-green-500 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(C,{className:"h-5 w-5 text-green-500"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-green-700",children:l})})]})}),b&&e.jsx("div",{className:"mt-4 bg-red-50 border-l-4 border-red-500 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(S,{className:"h-5 w-5 text-red-500"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:b})})]})}),e.jsxs("form",{onSubmit:w,className:"mt-5",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",name:"status",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md",value:n,onChange:s=>j(s.target.value),disabled:x,children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"note",className:"block text-sm font-medium text-gray-700",children:"Note (Optional)"}),e.jsx("input",{type:"text",name:"note",id:"note",className:"mt-1 focus:ring-orange-500 focus:border-orange-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"Add a note about this status change",value:N,onChange:s=>f(s.target.value),disabled:x})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"submit",className:`inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 ${x?"opacity-50 cursor-not-allowed":""}`,disabled:x,children:x?"Updating...":"Update Status"})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Order Items"}),e.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:[t.items.length," item(s) in this order"]})]}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:t.items.map(s=>e.jsx("li",{className:"px-4 py-4 sm:px-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-16 w-16",children:e.jsx("img",{className:"h-16 w-16 rounded-md object-cover",src:s.product.image,alt:s.product.name})}),e.jsx("div",{className:"ml-4 flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:s.product.name}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Sold by: ",s.outlet.name]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:g(s.price*s.quantity)}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[g(s.price)," x ",s.quantity]})]})]})})]})},s._id))})})]}),e.jsxs("div",{className:"mt-6 bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6",children:e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Customer Information"})}),e.jsxs("div",{className:"border-t border-gray-200 px-4 py-5 sm:px-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.customer.name})]}),e.jsxs("div",{className:"mt-2 flex items-center",children:[e.jsx(B,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:t.customer.email})]}),e.jsxs("div",{className:"mt-2 flex items-center",children:[e.jsx(E,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:t.customer.phone})]})]})]}),e.jsxs("div",{className:"mt-6 bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6",children:e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Shipping Address"})}),e.jsx("div",{className:"border-t border-gray-200 px-4 py-5 sm:px-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(F,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-900",children:t.shippingAddress.street}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[t.shippingAddress.city,", ",t.shippingAddress.state,", ",t.shippingAddress.zipCode]}),e.jsx("p",{className:"text-sm text-gray-500",children:t.shippingAddress.country})]})]})})]}),e.jsxs("div",{className:"mt-6 bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6",children:e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Payment Information"})}),e.jsx("div",{className:"border-t border-gray-200 px-4 py-5 sm:px-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:T(t.paymentMethod)})]}),e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${$(t.paymentStatus)}`,children:t.paymentStatus.charAt(0).toUpperCase()+t.paymentStatus.slice(1)})]})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6",children:e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Order Summary"})}),e.jsx("div",{className:"border-t border-gray-200 px-4 py-5 sm:px-6",children:e.jsxs("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-4",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Subtotal"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:g(t.subtotal)})]}),e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Shipping Fee"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:g(t.shippingFee)})]}),e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Tax"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:g(t.tax)})]}),e.jsxs("div",{className:"sm:col-span-1 border-t pt-4",children:[e.jsx("dt",{className:"text-base font-medium text-gray-900",children:"Total"}),e.jsx("dd",{className:"mt-1 text-base font-medium text-gray-900",children:g(t.totalAmount)})]})]})})]}),e.jsxs("div",{className:"mt-6 bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6",children:e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Status History"})}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:t.statusHistory.map((s,c)=>e.jsx("li",{className:"px-4 py-4 sm:px-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`h-8 w-8 rounded-full flex items-center justify-center ${i(s.status)}`,children:s.status==="delivered"?e.jsx(C,{className:"h-5 w-5"}):s.status==="cancelled"?e.jsx(S,{className:"h-5 w-5"}):s.status==="shipped"?e.jsx(I,{className:"h-5 w-5"}):s.status==="processing"?e.jsx(q,{className:"h-5 w-5"}):e.jsx(z,{className:"h-5 w-5"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),e.jsxs("p",{className:"text-sm text-gray-500",children:[k(s.timestamp)," ",new Date(s.timestamp).toLocaleTimeString()]})]}),s.note&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.note})]})]})},c))})})]})]})]})]})}):e.jsx("div",{className:"bg-gray-50 min-h-screen py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg p-6",children:[e.jsx("p",{className:"text-gray-500",children:"Order not found."}),e.jsx("div",{className:"mt-4",children:e.jsxs(M,{to:"/admin/orders",className:"text-orange-600 hover:text-orange-900 flex items-center",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Back to Orders"]})})]})})})};export{K as default};
