import{r as d,O as N,Q as q,j as e,V as A,W as P,Y as L,Z as O,_ as D,$ as S,a0 as H,A as M,a as $,e as b,B as j,a1 as z,a2 as k,I as U}from"./index-CW7sJ-MG.js";import{T as W}from"./textarea-B1GM8hMp.js";import{L as J}from"./loader-BXkacTqF.js";var C="Switch",[Q,re]=A(C),[V,X]=Q(C),E=d.forwardRef((r,l)=>{const{__scopeSwitch:t,name:c,checked:o,defaultChecked:g,required:m,disabled:u,value:i="on",onCheckedChange:x,form:p,...s}=r,[a,n]=d.useState(null),h=N(l,w=>n(w)),f=d.useRef(!1),y=a?p||!!a.closest("form"):!0,[v,B]=q({prop:o,defaultProp:g??!1,onChange:x,caller:C});return e.jsxs(V,{scope:t,checked:v,disabled:u,children:[e.jsx(P.button,{type:"button",role:"switch","aria-checked":v,"aria-required":m,"data-state":R(v),"data-disabled":u?"":void 0,disabled:u,value:i,...s,ref:h,onClick:L(r.onClick,w=>{B(I=>!I),y&&(f.current=w.isPropagationStopped(),f.current||w.stopPropagation())})}),y&&e.jsx(F,{control:a,bubbles:!f.current,name:c,value:i,checked:v,required:m,disabled:u,form:p,style:{transform:"translateX(-100%)"}})]})});E.displayName=C;var T="SwitchThumb",_=d.forwardRef((r,l)=>{const{__scopeSwitch:t,...c}=r,o=X(T,t);return e.jsx(P.span,{"data-state":R(o.checked),"data-disabled":o.disabled?"":void 0,...c,ref:l})});_.displayName=T;var Y="SwitchBubbleInput",F=d.forwardRef(({__scopeSwitch:r,control:l,checked:t,bubbles:c=!0,...o},g)=>{const m=d.useRef(null),u=N(m,g),i=O(t),x=D(l);return d.useEffect(()=>{const p=m.current;if(!p)return;const s=window.HTMLInputElement.prototype,n=Object.getOwnPropertyDescriptor(s,"checked").set;if(i!==t&&n){const h=new Event("click",{bubbles:c});n.call(p,t),p.dispatchEvent(h)}},[i,t,c]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...o,tabIndex:-1,ref:u,style:{...o.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});F.displayName=Y;function R(r){return r?"checked":"unchecked"}var Z=E,G=_;function K({className:r,...l}){return e.jsx(Z,{"data-slot":"switch",className:S("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),...l,children:e.jsx(G,{"data-slot":"switch-thumb",className:S("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const se=()=>{const{id:r}=H(),l=M(),{currentUser:t}=$(s=>s.user),[c,o]=d.useState({categoryName:"",description:"",featured:!1,outlet:t==null?void 0:t._id}),[g,m]=d.useState(!1),[u,i]=d.useState("");d.useEffect(()=>{if(!t){i("Please log in as an outlet user to create a category"),b.error("Please log in as an outlet user");return}o(s=>({...s,outlet:t._id})),r&&(async()=>{try{const a=await fetch(`/api/route/categories/${r}`),n=await a.json();if(!a.ok)throw new Error(n.message||"Failed to fetch category");o({categoryName:n.categoryName,description:n.description,featured:n.featured,outlet:n.outlet})}catch(a){b.error("Error loading category"),console.error(a)}})()},[t,r]);const x=s=>{const{name:a,value:n,type:h,checked:f}=s.target;o(y=>({...y,[a]:h==="checkbox"?f:n})),i("")},p=async s=>{if(s.preventDefault(),!t){i("Authentication required"),b.error("Authentication required");return}if(!c.categoryName.trim()){i("Category name is required"),b.error("Category name is required");return}m(!0),i("");try{const a=r?`/api/route/categories/${r}`:"/api/route/categories",h=await fetch(a,{method:r?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),f=await h.json();if(!h.ok)throw new Error(f.message||`HTTP error ${h.status}`);b.success(r?"Category updated":"Category created"),o({categoryName:"",description:"",featured:!1,outlet:t._id}),l("/outlet/categories")}catch(a){console.error("Category operation error:",a.message),i(a.message||"Failed to save category"),b.error(a.message||"Failed to save category")}finally{m(!1)}};return e.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e.jsxs(j,{onClick:()=>l(-1),variant:"ghost",children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," Back"]}),e.jsx("h1",{className:"text-2xl font-bold my-4",children:r?"Edit Category":"Create Category"}),u&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4",children:e.jsx("p",{className:"text-sm text-red-700",children:u})}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(k,{htmlFor:"categoryName",children:"Name *"}),e.jsx(U,{id:"categoryName",name:"categoryName",value:c.categoryName,onChange:x,required:!0,className:u.includes("name")?"border-red-300":""})]}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"description",children:"Description"}),e.jsx(W,{id:"description",name:"description",value:c.description,onChange:x})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{id:"featured",name:"featured",checked:c.featured,onCheckedChange:s=>o(a=>({...a,featured:s}))}),e.jsx(k,{htmlFor:"featured",children:"Featured"})]}),e.jsx(j,{type:"submit",disabled:g||!t,children:g?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"animate-spin mr-2 h-4 w-4"}),"Saving..."]}):"Save"})]})]})};export{se as default};
