import{i as W,u as Z,a as J,r as p,j as e,k as I,l as L,U as O,I as h,M as Q,m as X,B as v,c as E,n as ee,o as se,p as re,q as ae,s as te,t as de,v as k,w as le,x as f,e as m}from"./index-CW7sJ-MG.js";import"./textarea-B1GM8hMp.js";import{u as T,F as V,a as l,b as n,c as o,d as c,e as x,S as U,f as ne}from"./form-DgzDGx5y.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$=W("lock",oe),fe=()=>{Z();const{user:g}=J(s=>s.auth),[ce,G]=p.useState({name:"",email:"",phone:""}),b=T({defaultValues:{name:"",email:"",phone:""}}),[ie,me]=p.useState({currentPassword:"",newPassword:"",confirmPassword:""}),P=T({defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}}),[B,C]=p.useState([]),[xe,he]=p.useState({title:"",street:"",city:"",state:"",postalCode:"",country:"Nigeria",isDefault:!1}),[K,D]=p.useState(!1),u=T({defaultValues:{title:"",street:"",city:"",state:"",postalCode:"",country:"Nigeria",isDefault:!1}}),[S,M]=p.useState("profile"),[F,j]=p.useState({profile:!1,password:!1,address:!1}),[q,w]=p.useState({profile:!1,password:!1,address:!1}),[A,N]=p.useState({profile:null,password:null,address:null});p.useEffect(()=>{g&&(G({name:g.name||"",email:g.email||"",phone:g.phone||""}),b.reset({name:g.name||"",email:g.email||"",phone:g.phone||""}),(async()=>{try{const t=await f.getAddresses();C(t.data||[])}catch(t){console.error("Failed to fetch addresses:",t),m.error("Failed to load your saved addresses")}})())},[g,b]);const R=async s=>{var t,d;j(r=>({...r,profile:!0})),N(r=>({...r,profile:null})),w(r=>({...r,profile:!1}));try{const r=await f.updateProfile(s);j(a=>({...a,profile:!1})),w(a=>({...a,profile:!0})),m.success("Profile updated successfully"),setTimeout(()=>{w(a=>({...a,profile:!1}))},3e3)}catch(r){j(a=>({...a,profile:!1})),N(a=>{var i,y;return{...a,profile:((y=(i=r.response)==null?void 0:i.data)==null?void 0:y.message)||"Failed to update profile"}}),m.error(((d=(t=r.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to update profile")}},Y=async s=>{var t,d;if(j(r=>({...r,password:!0})),N(r=>({...r,password:null})),w(r=>({...r,password:!1})),s.newPassword!==s.confirmPassword){N(r=>({...r,password:"New passwords do not match"})),j(r=>({...r,password:!1})),m.error("New passwords do not match");return}try{const r={currentPassword:s.currentPassword,newPassword:s.newPassword};await f.updatePassword(r),j(a=>({...a,password:!1})),w(a=>({...a,password:!0})),m.success("Password updated successfully"),P.reset({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>{w(a=>({...a,password:!1}))},3e3)}catch(r){j(a=>({...a,password:!1})),N(a=>{var i,y;return{...a,password:((y=(i=r.response)==null?void 0:i.data)==null?void 0:y.message)||"Failed to update password"}}),m.error(((d=(t=r.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to update password")}},_=async s=>{var t,d;j(r=>({...r,address:!0})),N(r=>({...r,address:null}));try{const r=await f.addAddress(s),a=await f.getAddresses();C(a.data||[]),D(!1),u.reset({title:"",street:"",city:"",state:"",postalCode:"",country:"Nigeria",isDefault:!1}),w(i=>({...i,address:!0})),m.success("Address added successfully"),setTimeout(()=>{w(i=>({...i,address:!1}))},3e3)}catch(r){N(a=>{var i,y;return{...a,address:((y=(i=r.response)==null?void 0:i.data)==null?void 0:y.message)||"Failed to add address"}}),m.error(((d=(t=r.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to add address")}finally{j(r=>({...r,address:!1}))}},z=async s=>{var t,d;try{await f.deleteAddress(s);const r=await f.getAddresses();C(r.data||[]),m.success("Address deleted successfully")}catch(r){m.error(((d=(t=r.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to delete address")}},H=async s=>{var t,d;try{await f.setDefaultAddress(s);const r=await f.getAddresses();C(r.data||[]),m.success("Default address updated")}catch(r){m.error(((d=(t=r.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to update default address")}};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Profile"}),e.jsx("p",{className:"text-gray-600",children:"Manage your account information and preferences"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>M("profile"),className:`py-4 px-1 border-b-2 font-medium text-sm ${S==="profile"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Personal Information"}),e.jsx("button",{onClick:()=>M("security"),className:`py-4 px-1 border-b-2 font-medium text-sm ${S==="security"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Security"}),e.jsx("button",{onClick:()=>M("addresses"),className:`py-4 px-1 border-b-2 font-medium text-sm ${S==="addresses"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Addresses"})]})}),e.jsxs("div",{className:"p-6",children:[S==="profile"&&e.jsx("div",{children:e.jsx(V,{...b,children:e.jsxs("form",{onSubmit:b.handleSubmit(R),children:[A.profile&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md flex items-start",children:[e.jsx(I,{className:"h-5 w-5 text-red-500 mr-2 mt-0.5"}),e.jsx("span",{className:"text-red-700",children:A.profile})]}),q.profile&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-md flex items-start",children:[e.jsx(L,{className:"h-5 w-5 text-green-500 mr-2 mt-0.5"}),e.jsx("span",{className:"text-green-700",children:"Profile updated successfully!"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 mb-6",children:[e.jsx(l,{control:b.control,name:"name",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(O,{className:"h-5 w-5 text-gray-400"})}),e.jsx(c,{children:e.jsx(h,{...s,className:"pl-10",placeholder:"Your full name",required:!0})})]}),e.jsx(x,{})]})}),e.jsx(l,{control:b.control,name:"email",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Q,{className:"h-5 w-5 text-gray-400"})}),e.jsx(c,{children:e.jsx(h,{...s,type:"email",className:"pl-10",placeholder:"your.email@example.com",required:!0})})]}),e.jsx(x,{})]})}),e.jsx(l,{control:b.control,name:"phone",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(X,{className:"h-5 w-5 text-gray-400"})}),e.jsx(c,{children:e.jsx(h,{...s,type:"tel",className:"pl-10",placeholder:"+234 123 456 7890"})})]}),e.jsx(x,{})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(v,{type:"submit",disabled:F.profile,className:"bg-orange-600 hover:bg-orange-700 focus:ring-orange-500",children:F.profile?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"animate-spin h-4 w-4"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4"}),"Save Changes"]})})})]})})}),S==="security"&&e.jsx("div",{children:e.jsx(V,{...P,children:e.jsxs("form",{onSubmit:P.handleSubmit(Y),children:[A.password&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md flex items-start",children:[e.jsx(I,{className:"h-5 w-5 text-red-500 mr-2 mt-0.5"}),e.jsx("span",{className:"text-red-700",children:A.password})]}),q.password&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-md flex items-start",children:[e.jsx(L,{className:"h-5 w-5 text-green-500 mr-2 mt-0.5"}),e.jsx("span",{className:"text-green-700",children:"Password updated successfully!"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 mb-6",children:[e.jsx(l,{control:P.control,name:"currentPassword",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx($,{className:"h-5 w-5 text-gray-400"})}),e.jsx(c,{children:e.jsx(h,{...s,type:"password",className:"pl-10",placeholder:"Enter your current password",required:!0})})]}),e.jsx(x,{})]})}),e.jsx(l,{control:P.control,name:"newPassword",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx($,{className:"h-5 w-5 text-gray-400"})}),e.jsx(c,{children:e.jsx(h,{...s,type:"password",className:"pl-10",placeholder:"Enter new password",required:!0,minLength:6})})]}),e.jsx(ne,{children:"Password must be at least 6 characters long"}),e.jsx(x,{})]})}),e.jsx(l,{control:P.control,name:"confirmPassword",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx($,{className:"h-5 w-5 text-gray-400"})}),e.jsx(c,{children:e.jsx(h,{...s,type:"password",className:"pl-10",placeholder:"Confirm new password",required:!0})})]}),e.jsx(x,{})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(v,{type:"submit",disabled:F.password,className:"bg-orange-600 hover:bg-orange-700 focus:ring-orange-500",children:F.password?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"animate-spin h-4 w-4"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4"}),"Update Password"]})})})]})})}),S==="addresses"&&e.jsxs("div",{children:[A.address&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md flex items-start",children:[e.jsx(I,{className:"h-5 w-5 text-red-500 mr-2 mt-0.5"}),e.jsx("span",{className:"text-red-700",children:A.address})]}),q.address&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-md flex items-start",children:[e.jsx(L,{className:"h-5 w-5 text-green-500 mr-2 mt-0.5"}),e.jsx("span",{className:"text-green-700",children:"Address saved successfully!"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Your Addresses"}),e.jsxs(v,{type:"button",onClick:()=>D(!0),className:"bg-orange-600 hover:bg-orange-700 focus:ring-orange-500",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Add New Address"]})]}),B.length===0?e.jsxs("div",{className:"text-center py-8 border border-dashed border-gray-300 rounded-md",children:[e.jsx(se,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"No addresses yet"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add a new address to save your delivery information"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:B.map(s=>e.jsxs("div",{className:`border rounded-md p-4 relative ${s.isDefault?"border-orange-300 bg-orange-50":"border-gray-200"}`,children:[s.isDefault&&e.jsx("span",{className:"absolute top-2 right-2 px-2 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded",children:"Default"}),e.jsx("div",{className:"mb-2",children:e.jsx("h4",{className:"font-medium text-gray-900",children:s.title})}),e.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[e.jsx("p",{children:s.street}),e.jsxs("p",{children:[s.city,", ",s.state," ",s.postalCode]}),e.jsx("p",{children:s.country})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[!s.isDefault&&e.jsx(v,{type:"button",variant:"link",onClick:()=>H(s.id),className:"text-xs text-orange-600 hover:text-orange-800 p-0 h-auto",children:"Set as Default"}),e.jsx(v,{type:"button",variant:"link",onClick:()=>z(s.id),className:"text-xs text-red-600 hover:text-red-800 p-0 h-auto",children:"Delete"})]})]},s.id))})]}),K&&e.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Address"}),e.jsx(V,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(_),children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsx(l,{control:u.control,name:"title",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Address Title *"}),e.jsx(c,{children:e.jsx(h,{...s,placeholder:"Home, Work, etc.",required:!0})}),e.jsx(x,{})]})}),e.jsx(l,{control:u.control,name:"street",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Street Address *"}),e.jsx(c,{children:e.jsx(h,{...s,placeholder:"123 Main St",required:!0})}),e.jsx(x,{})]})}),e.jsx(l,{control:u.control,name:"city",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"City *"}),e.jsx(c,{children:e.jsx(h,{...s,placeholder:"Lagos",required:!0})}),e.jsx(x,{})]})}),e.jsx(l,{control:u.control,name:"state",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"State/Province *"}),e.jsx(c,{children:e.jsx(h,{...s,placeholder:"Lagos State",required:!0})}),e.jsx(x,{})]})}),e.jsx(l,{control:u.control,name:"postalCode",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Postal/ZIP Code"}),e.jsx(c,{children:e.jsx(h,{...s,placeholder:"100001"})}),e.jsx(x,{})]})}),e.jsx(l,{control:u.control,name:"country",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Country *"}),e.jsxs(re,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(c,{children:e.jsx(ae,{children:e.jsx(te,{placeholder:"Select Country"})})}),e.jsxs(de,{children:[e.jsx(k,{value:"Nigeria",children:"Nigeria"}),e.jsx(k,{value:"Ghana",children:"Ghana"}),e.jsx(k,{value:"Kenya",children:"Kenya"}),e.jsx(k,{value:"South Africa",children:"South Africa"})]})]}),e.jsx(x,{})]})})]}),e.jsx("div",{className:"flex items-center mb-6",children:e.jsx(l,{control:u.control,name:"isDefault",render:({field:s})=>e.jsxs(n,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(c,{children:e.jsx(le,{checked:s.value,onCheckedChange:s.onChange,id:"isDefault"})}),e.jsx("div",{className:"space-y-1 leading-none",children:e.jsx(o,{htmlFor:"isDefault",children:"Set as default address"})})]})})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>D(!1),children:"Cancel"}),e.jsx(v,{type:"submit",disabled:F.address,className:"bg-orange-600 hover:bg-orange-700 focus:ring-orange-500",children:F.address?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"animate-spin h-4 w-4 mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Save Address"]})})]})]})})]})]})]})]})]})};export{fe as default};
