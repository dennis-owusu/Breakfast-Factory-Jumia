import{r as c,j as e,J as f,B as j}from"./index-CW7sJ-MG.js";import"./textarea-B1GM8hMp.js";const w=()=>{const[l,d]=c.useState([]),[y,o]=c.useState(!1),[i,x]=c.useState(null),[p,h]=c.useState(null);c.useEffect(()=>{N()},[]);const N=async()=>{try{o(!0);const t=await(await fetch("/api/route/all")).json();d(t.requests)}catch(s){x(s.message)}finally{o(!1)}},m=async(s,t,a)=>{try{h(s);const n=await fetch(`/api/route/process/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t,adminNote:a})}),u=await n.json();if(!n.ok)throw new Error(u.message);d(l.map(r=>r._id===s?{...r,status:t,adminNote:a,processedAt:new Date().toISOString()}:r))}catch(n){x(n.message)}finally{h(null)}},g=s=>{switch(s){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Restock Requests Management"}),e.jsx(f,{children:e.jsx("div",{className:"p-6",children:y?e.jsx("div",{className:"text-center py-4",children:"Loading requests..."}):i?e.jsx("div",{className:"text-red-500 py-4",children:i}):l.length===0?e.jsx("div",{className:"text-center py-4",children:"No restock requests found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4",children:"Outlet"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Current Qty"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Requested Qty"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(s=>{var t;return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:s.outlet.name}),e.jsx("td",{className:"py-3 px-4",children:((t=s.product)==null?void 0:t.productName)||"Unknown Product"}),e.jsx("td",{className:"py-3 px-4",children:s.currentQuantity}),e.jsx("td",{className:"py-3 px-4",children:s.requestedQuantity}),e.jsx("td",{className:"py-3 px-4",children:s.reason}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-sm ${g(s.status)}`,children:s.status})}),e.jsx("td",{className:"py-3 px-4",children:new Date(s.createdAt).toLocaleDateString()}),e.jsxs("td",{className:"py-3 px-4",children:[s.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:()=>{const a=prompt("Add a note (optional):");m(s._id,"approved",a)},disabled:p===s._id,className:"bg-green-500 hover:bg-green-600",children:"Approve"}),e.jsx(j,{onClick:()=>{const a=prompt("Add a reason for rejection:");a&&m(s._id,"rejected",a)},disabled:p===s._id,className:"bg-red-500 hover:bg-red-600",children:"Reject"})]}),s.adminNote&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Note: ",s.adminNote]})]})]},s._id)})})]})})})})]})};export{w as default};
