import{i as I,a0 as k,A as z,a as B,r as o,j as e,c as L,B as u,h as U,p as q,q as _,s as M,t as V,v as d,e as x}from"./index-CW7sJ-MG.js";import{B as H}from"./badge-D5WoGv9G.js";import{E as Q}from"./jspdf.es.min-bEY5U2vA.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],G=I("printer",R),X=()=>{var b,v,w,S,C,P;const{id:m}=k(),$=z(),{currentUser:n}=B(s=>s.user),[a,h]=o.useState(null),[F,p]=o.useState(!0),[g,T]=o.useState(null),[j,N]=o.useState(""),f="http://localhost:3000";o.useEffect(()=>{n&&(async()=>{try{p(!0);const t={"Content-Type":"application/json",Authorization:`Bearer ${n.token}`},r=await fetch(`${f}/api/route/getOrder/${m}`,{headers:t});if(!r.ok)throw new Error("Failed to fetch order");const i=await r.json();h(i)}catch(t){T(t.message),x.error(t.message)}finally{p(!1)}})()},[m,n]),o.useEffect(()=>{a&&N(a.status)},[a]);const y=s=>new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),l=s=>`GHS ${s.toFixed(2)}`,A=async()=>{try{const s={"Content-Type":"application/json",Authorization:`Bearer ${n.token}`},t=await fetch(`${f}/api/route/updateOrder/${m}`,{method:"PUT",headers:s,body:JSON.stringify({status:j})});if(!t.ok)throw new Error("Failed to update status");const r=await t.json();h(r),x.success("Order status updated successfully")}catch(s){x.error(s.message)}},E=()=>{var r,i,D,O;const s=new Q("p","pt","a4");let t=60;s.setFontSize(24),s.setTextColor(0,102,204),s.text("Invoice",40,t),s.setTextColor(0,0,0),t+=50,s.setFontSize(14),s.text(`Date: ${y(a.createdAt)}`,40,t),t+=30,s.text(`Status: ${a.status.charAt(0).toUpperCase()+a.status.slice(1)}`,40,t),t+=50,s.setFontSize(16),s.setTextColor(0,102,204),s.text("Customer",40,t),s.setTextColor(0,0,0),t+=30,s.setFontSize(12),s.text(`Name: ${((r=a.user)==null?void 0:r.name)||((i=a.userInfo)==null?void 0:i.name)||"N/A"}`,40,t),t+=25,s.text(`Email: ${((D=a.user)==null?void 0:D.email)||((O=a.userInfo)==null?void 0:O.email)||"N/A"}`,40,t),t+=50,s.setFontSize(16),s.setTextColor(0,102,204),s.text("Order Items",40,t),s.setTextColor(0,0,0),t+=30,s.setFontSize(12),s.setDrawColor(0,102,204),s.setLineWidth(.5),s.line(40,t,550,t),s.setDrawColor(0,0,0),t+=20,s.text("Product",40,t),s.text("Qty",300,t),s.text("Price",370,t),s.text("Subtotal",460,t),t+=10,s.setDrawColor(0,102,204),s.line(40,t,550,t),s.setDrawColor(0,0,0),t+=20,a.products.forEach(c=>{s.text(c.product.name,40,t),s.text(c.quantity.toString(),300,t),s.text(l(c.product.price),370,t),s.text(l(c.product.price*c.quantity),460,t),t+=25}),s.setDrawColor(0,102,204),s.line(40,t,550,t),s.setDrawColor(0,0,0),t+=30,s.setFontSize(14),s.setTextColor(255,0,0),s.text(`Total: ${l(a.totalPrice)}`,40,t),s.setTextColor(0,0,0),s.save(`order-${a.orderNumber||a._id}.pdf`)};return F?e.jsx(L,{}):g?e.jsx("div",{className:"text-red-500",children:g}):a?e.jsx("div",{className:"container mx-auto p-4 md:p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center p-6 border-b",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 mb-4 sm:mb-0",children:["Order #",a.orderNumber||a._id]}),e.jsxs("div",{className:"flex flex-col xs:flex-row w-full sm:w-auto space-y-2 xs:space-y-0 xs:space-x-3",children:[e.jsxs(u,{variant:"outline",className:"w-full sm:w-auto border-gray-300 hover:bg-gray-100",onClick:()=>$(-1),children:[e.jsx(U,{className:"mr-2 h-4 w-4"})," Back"]}),e.jsxs(u,{variant:"outline",className:"w-full sm:w-auto border-gray-300 hover:bg-gray-100",onClick:E,children:[e.jsx(G,{className:"mr-2 h-4 w-4"})," Download PDF"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Customer Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",((b=a.user)==null?void 0:b.name)||((v=a.userInfo)==null?void 0:v.name)||"N/A"]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",((w=a.user)==null?void 0:w.email)||((S=a.userInfo)==null?void 0:S.email)||"N/A"]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Phone:"})," ",((C=a.user)==null?void 0:C.phoneNumber)||((P=a.userInfo)==null?void 0:P.phoneNumber)||a.phoneNumber||"N/A"]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Shipping Address"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("p",{className:"text-gray-600",children:[a.address,", ",a.city,", ",a.state," ",a.postalCode]})})]})]}),e.jsxs("div",{className:"p-6 border-t",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Order Details"}),e.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Status"}),e.jsx(H,{className:"mt-1 bg-blue-100 text-blue-800",children:a.status})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Date"}),e.jsx("p",{className:"mt-1 text-sm text-green-900",children:y(a.createdAt)})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm font-medium text-purple-800",children:"Payment Method"}),e.jsx("p",{className:"mt-1 text-sm text-purple-900",children:a.paymentMethod})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm font-medium text-indigo-800",children:"Total"}),e.jsx("p",{className:"mt-1 text-sm text-indigo-900 font-bold",children:l(a.totalPrice)})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(q,{value:j,onValueChange:N,children:[e.jsx(_,{className:"w-full sm:w-[180px]",children:e.jsx(M,{placeholder:"Update Status"})}),e.jsxs(V,{children:[e.jsx(d,{value:"pending",children:"Pending"}),e.jsx(d,{value:"processing",children:"Processing"}),e.jsx(d,{value:"shipped",children:"Shipped"}),e.jsx(d,{value:"delivered",children:"Delivered"}),e.jsx(d,{value:"cancelled",children:"Cancelled"})]})]}),e.jsx(u,{onClick:A,className:"w-full sm:w-auto",children:"Update Status"})]})})]}),e.jsxs("div",{className:"p-6 border-t",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Products"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Image"}),e.jsx("th",{className:"px-6 py-3",children:"Product"}),e.jsx("th",{className:"px-6 py-3",children:"Quantity"}),e.jsx("th",{className:"px-6 py-3",children:"Price"}),e.jsx("th",{className:"px-6 py-3",children:"Subtotal"})]})}),e.jsx("tbody",{children:a.products.map((s,t)=>e.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("img",{src:`${s.product.images[0]}`,alt:s.product.name,className:"w-16 h-16 object-cover rounded",onError:r=>{r.target.src="https://via.placeholder.com/150?text=Image+Not+Found",x.error(`Failed to load image for ${s.product.name}`)}})}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:s.product.name}),e.jsx("td",{className:"px-6 py-4",children:s.quantity}),e.jsx("td",{className:"px-6 py-4",children:l(s.product.price)}),e.jsx("td",{className:"px-6 py-4 font-medium",children:l(s.product.price*s.quantity)})]},t))})]})})]})]})}):e.jsx("div",{children:"Order not found"})};export{X as default};
