import{r as c,j as e,c as E,l as L,a6 as V,g as X,d as P,L as T,E as G,T as Q,h as W,C as Y}from"./index-CW7sJ-MG.js";import{S as Z}from"./square-pen-C0ENrl1l.js";import{C as ee}from"./circle-x-B3lywMU5.js";const te=async a=>{try{const o=localStorage.getItem("token"),r=new URLSearchParams({startIndex:((a.page-1)*a.limit).toString(),limit:a.limit.toString(),searchTerm:a.search||"",category:a.category!=="all"?a.category:"",featured:a.featured!=="all"?a.featured==="featured":""}),i=await fetch(`/api/route/allproducts?${r}`,{headers:{Authorization:`Bearer ${o}`}});if(!i.ok)throw new Error("Failed to fetch products");const x=await i.json();return{products:x.products.map(l=>{var p;return{_id:l._id,name:l.productName,description:l.description,price:l.productPrice,discountPrice:l.discountPrice,stock:l.numberOfProductsAvailable,images:[l.productImage],category:((p=l.category)==null?void 0:p.categoryName)||"Uncategorized",featured:l.featured,outlet:l.outlet,createdAt:l.createdAt}}),pagination:{total:x.totalProducts,totalPages:Math.ceil(x.totalProducts/a.limit),currentPage:a.page,limit:a.limit}}}catch(o){throw new Error("Failed to fetch products: "+o.message)}},se=async(a,o)=>{try{const r=localStorage.getItem("token"),i=await fetch(`/api/update/${a}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({status:o})});if(!i.ok){const l=await i.json();throw new Error(l.message||"Failed to update product status")}return await i.json()}catch(r){throw new Error("Failed to update product status: "+r.message)}},ae=async(a,o)=>{try{const r=localStorage.getItem("token"),i=await fetch(`/api/update/${a}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({featured:o})});if(!i.ok){const l=await i.json();throw new Error(l.message||"Failed to update product featured status")}return await i.json()}catch(r){throw new Error("Failed to update product featured status: "+r.message)}},re=async a=>{try{const o=localStorage.getItem("token"),r=await fetch(`/api/delete/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}});if(!r.ok){const x=await r.json();throw new Error(x.message||"Failed to delete product")}return await r.json()}catch(o){throw new Error("Failed to delete product: "+o.message)}},oe=()=>{const[a,o]=c.useState(""),[r,i]=c.useState("all"),[x,l]=c.useState("all"),[p,_]=c.useState("all"),[k,z]=c.useState("all"),[d,m]=c.useState(1),[w]=c.useState(10),[N,b]=c.useState([]),[u,S]=c.useState({total:0,totalPages:0,currentPage:1,limit:10}),[C,F]=c.useState(!0),[A,h]=c.useState(null),[y,f]=c.useState(!1),[$,j]=c.useState(""),M=["Electronics","Fashion","Home & Kitchen","Beauty","Books","Sports"];c.useEffect(()=>{(async()=>{try{F(!0);const s=await te({search:a,category:r,status:x,stock:p,featured:k,page:d,limit:w});b(s.products),S(s.pagination),h(null)}catch{h("Failed to load products. Please try again later.")}finally{F(!1)}})()},[a,r,x,p,k,d,w]);const B=t=>{o(t.target.value),m(1)},U=t=>{i(t.target.value),m(1)},O=t=>{l(t.target.value),m(1)},R=t=>{_(t.target.value),m(1)},I=t=>{z(t.target.value),m(1)},D=()=>{d>1&&m(d-1)},q=()=>{d<u.totalPages&&m(d+1)},J=async(t,s)=>{if(window.confirm(`Are you sure you want to ${s==="active"?"activate":"deactivate"} this product?`))try{f(!0);const n=await se(t,s);n.success?(b(v=>v.map(g=>g._id===t?{...g,status:s}:g)),j(n.message),setTimeout(()=>{j("")},3e3)):h("Failed to update product status. Please try again.")}catch{h("An error occurred. Please try again later.")}finally{f(!1)}},H=async(t,s)=>{if(window.confirm(`Are you sure you want to ${s?"feature":"unfeature"} this product?`))try{f(!0);const n=await ae(t,s);n.success?(b(v=>v.map(g=>g._id===t?{...g,featured:s}:g)),j(n.message),setTimeout(()=>{j("")},3e3)):h("Failed to update product featured status. Please try again.")}catch{h("An error occurred. Please try again later.")}finally{f(!1)}},K=async t=>{if(window.confirm("Are you sure you want to delete this product? This action cannot be undone."))try{f(!0);const s=await re(t);s.success?(b(n=>n.filter(v=>v._id!==t)),S(n=>({...n,total:n.total-1,totalPages:Math.ceil((n.total-1)/w)})),j(s.message),setTimeout(()=>{j("")},3e3)):h("Failed to delete product. Please try again.")}catch{h("An error occurred. Please try again later.")}finally{f(!1)}};return C&&N.length===0?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(E,{size:"lg"})}):e.jsx("div",{className:"bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"Products Management"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage all products on the platform"})]}),$&&e.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(L,{className:"h-5 w-5 text-green-500"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-green-700",children:$})})]})}),A&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(V,{className:"h-5 w-5 text-red-500"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:A})})]})}),e.jsx("div",{className:"bg-white shadow rounded-lg mb-6",children:e.jsx("div",{className:"px-4 py-5 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 sr-only",children:"Search"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(X,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"search",id:"search",className:"focus:ring-orange-500 focus:border-orange-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search by name, description, category, brand, or outlet",value:a,onChange:B})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700",children:"Category"}),e.jsxs("select",{id:"category",name:"category",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md",value:r,onChange:U,children:[e.jsx("option",{value:"all",children:"All Categories"}),M.map((t,s)=>e.jsx("option",{value:t,children:t},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",name:"status",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md",value:x,onChange:O,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stock",className:"block text-sm font-medium text-gray-700",children:"Stock"}),e.jsxs("select",{id:"stock",name:"stock",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md",value:p,onChange:R,children:[e.jsx("option",{value:"all",children:"All Stock"}),e.jsx("option",{value:"in-stock",children:"In Stock"}),e.jsx("option",{value:"out-of-stock",children:"Out of Stock"}),e.jsx("option",{value:"low-stock",children:"Low Stock (â‰¤10)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"featured",className:"block text-sm font-medium text-gray-700",children:"Featured"}),e.jsxs("select",{id:"featured",name:"featured",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md",value:k,onChange:I,children:[e.jsx("option",{value:"all",children:"All Products"}),e.jsx("option",{value:"featured",children:"Featured Only"}),e.jsx("option",{value:"not-featured",children:"Not Featured"})]})]})]})})}),e.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[C&&N.length>0&&e.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx(E,{size:"sm"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Refreshing data..."})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category / Brand"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock / Sold"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rating"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Outlet"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No products found matching your criteria"})}):N.map(t=>{var s,n;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("img",{className:"h-10 w-10 rounded-md object-cover",src:((s=t.images)==null?void 0:s[0])||"/placeholder-image.jpg",alt:t.name||"Product"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500 max-w-xs truncate",children:t.description}),t.featured&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 mt-1",children:"Featured"})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.category}),e.jsx("div",{className:"text-sm text-gray-500",children:t.brand})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.discountPrice?e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:P(t.discountPrice)}),e.jsx("div",{className:"text-xs text-gray-500 line-through",children:P(t.price)})]}):e.jsx("div",{className:"text-sm text-gray-900",children:P(t.price)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:["Stock: ",t.stock===0?e.jsx("span",{className:"text-red-600 font-medium",children:"Out of stock"}):t.stock<=10?e.jsxs("span",{className:"text-yellow-600 font-medium",children:[t.stock," (Low)"]}):e.jsx("span",{children:t.stock})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Sold: ",t.sold]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),e.jsxs("span",{className:"ml-1 text-sm text-gray-600",children:[t.rating," (",t.numReviews,")"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:((n=t.outlet)==null?void 0:n.name)||"Unknown Outlet"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.status?t.status.charAt(0).toUpperCase()+t.status.slice(1):"Unknown"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(T,{to:`/admin/products/${t._id}`,className:"text-orange-600 hover:text-orange-900",title:"View Details",children:e.jsx(G,{className:"h-5 w-5"})}),e.jsx(T,{to:`/admin/products/${t._id}/edit`,className:"text-blue-600 hover:text-blue-900",title:"Edit Product",children:e.jsx(Z,{className:"h-5 w-5"})}),e.jsx("button",{type:"button",onClick:()=>J(t._id,t.status==="active"?"inactive":"active"),disabled:y,className:`${t.status==="active"?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"} ${y?"opacity-50 cursor-not-allowed":""}`,title:t.status==="active"?"Deactivate Product":"Activate Product",children:t.status==="active"?e.jsx(ee,{className:"h-5 w-5"}):e.jsx(L,{className:"h-5 w-5"})}),e.jsx("button",{type:"button",onClick:()=>H(t._id,!t.featured),disabled:y,className:`text-yellow-600 hover:text-yellow-900 ${y?"opacity-50 cursor-not-allowed":""}`,title:t.featured?"Remove from Featured":"Mark as Featured",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),e.jsx("button",{type:"button",onClick:()=>K(t._id),disabled:y,className:`text-red-600 hover:text-red-900 ${y?"opacity-50 cursor-not-allowed":""}`,title:"Delete Product",children:e.jsx(Q,{className:"h-5 w-5"})})]})})]},t._id)})})]})}),u.totalPages>1&&e.jsx("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(d-1)*w+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(d*w,u.total)})," of"," ",e.jsx("span",{className:"font-medium",children:u.total})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsxs("button",{onClick:D,disabled:d===1,className:`relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${d===1?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx(W,{className:"h-5 w-5","aria-hidden":"true"})]}),Array.from({length:u.totalPages},(t,s)=>s+1).map(t=>e.jsx("button",{onClick:()=>m(t),className:`relative inline-flex items-center px-4 py-2 border ${t===d?"z-10 bg-orange-50 border-orange-500 text-orange-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"} text-sm font-medium`,children:t},t)),e.jsxs("button",{onClick:q,disabled:d===u.totalPages,className:`relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${d===u.totalPages?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx(Y,{className:"h-5 w-5","aria-hidden":"true"})]})]})})]})})]})]})})};export{oe as default};
